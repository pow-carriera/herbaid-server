"use strict";(self.webpackChunkherbaid_server=self.webpackChunkherbaid_server||[]).push([[1495],{82781:(N,Z,a)=>{a.r(Z),a.d(Z,{default:()=>ie});var e=a(67294),S=a(97132),d=a(68547),T=a(185),b=a(49066),h=a(7681),P=a(35961),C=a(11276),u=a(74571),c=a(72735),m=a(16364),V=a(29728),G=a(14087),W=a(23293),$=a(45697),M=a.n($),U=a(71893),Y=a(91216),J=a(82562),s=a(47560);const Q=U.default.a`
  color: ${({theme:t})=>t.colors.primary600};
`,x=({config:t})=>{const{formatMessage:n}=(0,S.useIntl)();return e.createElement(h.K,{spacing:4},e.createElement(h.K,{spacing:1},e.createElement(c.Z,{variant:"delta",as:"h2"},n({id:(0,s.Z)("Settings.email.plugin.title.config"),defaultMessage:"Configuration"})),e.createElement(c.Z,null,n({id:(0,s.Z)("Settings.email.plugin.text.configuration"),defaultMessage:"The plugin is configured through the {file} file, checkout this {link} for the documentation."},{file:"./config/plugins.js",link:e.createElement(Q,{href:"https://docs.strapi.io/developer-docs/latest/plugins/email.html",target:"_blank",rel:"noopener noreferrer"},n({id:(0,s.Z)("link"),defaultMessage:"Link"}))}))),e.createElement(C.r,{gap:5},e.createElement(u.P,{col:6,s:12},e.createElement(m.o,{name:"shipper-email",label:n({id:(0,s.Z)("Settings.email.plugin.label.defaultFrom"),defaultMessage:"Default sender email"}),placeholder:n({id:(0,s.Z)("Settings.email.plugin.placeholder.defaultFrom"),defaultMessage:"ex: Strapi No-Reply '<'no-reply@strapi.io'>'"}),disabled:!0,onChange:()=>{},value:t.settings.defaultFrom})),e.createElement(u.P,{col:6,s:12},e.createElement(m.o,{name:"response-email",label:n({id:(0,s.Z)("Settings.email.plugin.label.defaultReplyTo"),defaultMessage:"Default response email"}),placeholder:n({id:(0,s.Z)("Settings.email.plugin.placeholder.defaultReplyTo"),defaultMessage:"ex: Strapi '<'example@strapi.io'>'"}),disabled:!0,onChange:()=>{},value:t.settings.defaultReplyTo})),e.createElement(u.P,{col:6,s:12},e.createElement(Y.P,{name:"email-provider",label:n({id:(0,s.Z)("Settings.email.plugin.label.provider"),defaultMessage:"Email provider"}),disabled:!0,onChange:()=>{},value:t.provider},e.createElement(J.W,{value:t.provider},t.provider)))))};x.propTypes={config:M().shape({provider:M().string,settings:M().shape({defaultFrom:M().string,defaultReplyTo:M().string})}).isRequired};const X=x;var R=a(53209);const L=R.Ry().shape({email:R.Z_().email(d.translatedErrors.email).required(d.translatedErrors.required)});var k=a(61321),q=a(78648),_=(t,n,i)=>new Promise((r,p)=>{var E=l=>{try{o(i.next(l))}catch(g){p(g)}},f=l=>{try{o(i.throw(l))}catch(g){p(g)}},o=l=>l.done?r(l.value):Promise.resolve(l.value).then(E,f);o((i=i.apply(t,n)).next())});const I=q.Z.create({baseURL:""});I.interceptors.request.use(t=>_(void 0,null,function*(){return t.headers={Authorization:`Bearer ${d.auth.getToken()}`,Accept:"application/json","Content-Type":"application/json"},t}),t=>{Promise.reject(t)}),I.interceptors.response.use(t=>t,t=>{var n;throw((n=t.response)==null?void 0:n.status)===401&&(d.auth.clearAppStorage(),window.location.reload()),t});const D=(0,d.wrapAxiosInstance)(I);var F=(t,n,i)=>new Promise((r,p)=>{var E=l=>{try{o(i.next(l))}catch(g){p(g)}},f=l=>{try{o(i.throw(l))}catch(g){p(g)}},o=l=>l.done?r(l.value):Promise.resolve(l.value).then(E,f);o((i=i.apply(t,n)).next())});const ee=()=>F(void 0,null,function*(){const{data:t}=yield D.get("/email/settings");return t.config}),te=t=>F(void 0,null,function*(){yield D.post("/email/test",t)});var ae=a(67838);const B=()=>{const{formatMessage:t}=(0,S.useIntl)();return e.createElement(e.Fragment,null,e.createElement(d.SettingsPageTitle,{name:t({id:(0,s.Z)("Settings.email.plugin.title"),defaultMessage:"Configuration"})}),e.createElement(ae.T,{id:"title",title:t({id:(0,s.Z)("Settings.email.plugin.title"),defaultMessage:"Configuration"}),subtitle:t({id:(0,s.Z)("Settings.email.plugin.subTitle"),defaultMessage:"Test the settings for the Email plugin"})}))};var le=(t,n,i)=>new Promise((r,p)=>{var E=l=>{try{o(i.next(l))}catch(g){p(g)}},f=l=>{try{o(i.throw(l))}catch(g){p(g)}},o=l=>l.done?r(l.value):Promise.resolve(l.value).then(E,f);o((i=i.apply(t,n)).next())});const se=()=>e.createElement(d.CheckPagePermissions,{permissions:k.Z.settings},e.createElement(ne,null)),ne=()=>{var t,n;const i=(0,d.useNotification)(),{formatMessage:r}=(0,S.useIntl)(),{lockApp:p,unlockApp:E}=(0,d.useOverlayBlocker)(),{notifyStatus:f}=(0,G.G)();(0,d.useFocusWhenNavigate)();const[o,l]=(0,e.useState)({}),[g,O]=(0,e.useState)(!1),[j,w]=(0,e.useState)(!1),[y,z]=(0,e.useState)(""),[re,H]=(0,e.useState)(!1),[oe,de]=(0,e.useState)({provider:"",settings:{defaultFrom:"",defaultReplyTo:"",testAddress:""}});(0,e.useEffect)(()=>{O(!0),ee().then(v=>{var A;f(r({id:(0,s.Z)("Settings.email.plugin.notification.data.loaded"),defaultMessage:"Email settings data has been loaded"})),de(v);const K=(A=v==null?void 0:v.settings)==null?void 0:A.testAddress;K&&z(K)}).catch(()=>i({type:"warning",message:r({id:(0,s.Z)("Settings.email.plugin.notification.config.error"),defaultMessage:"Failed to retrieve the email config"})})).finally(()=>O(!1))},[r,i,f]),(0,e.useEffect)(()=>{o.email&&document.querySelector("#test-address-input").focus()},[o]),(0,e.useEffect)(()=>{L.validate({email:y},{abortEarly:!1}).then(()=>H(!0)).catch(()=>H(!1))},[y]);const ue=v=>{z(()=>v.target.value)},ce=v=>le(void 0,null,function*(){v.preventDefault();try{yield L.validate({email:y},{abortEarly:!1}),w(!0),p(),te({to:y}).then(()=>{i({type:"success",message:r({id:(0,s.Z)("Settings.email.plugin.notification.test.success"),defaultMessage:"Email test succeeded, check the {to} mailbox"},{to:y})})}).catch(()=>{i({type:"warning",message:r({id:(0,s.Z)("Settings.email.plugin.notification.test.error"),defaultMessage:"Failed to send a test mail to {to}"},{to:y})})}).finally(()=>{w(!1),E()})}catch(A){l((0,d.getYupInnerErrors)(A))}});return g?e.createElement(T.o,{labelledBy:"title","aria-busy":"true"},e.createElement(B,null),e.createElement(b.D,null,e.createElement(d.LoadingIndicatorPage,null))):e.createElement(T.o,{labelledBy:"title","aria-busy":j},e.createElement(B,null),e.createElement(b.D,null,e.createElement("form",{onSubmit:ce},e.createElement(h.K,{spacing:7},e.createElement(P.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(X,{config:oe})),e.createElement(P.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(h.K,{spacing:4},e.createElement(c.Z,{variant:"delta",as:"h2"},r({id:(0,s.Z)("Settings.email.plugin.title.test"),defaultMessage:"Test email delivery"})),e.createElement(C.r,{gap:5,alignItems:"end"},e.createElement(u.P,{col:6,s:12},e.createElement(m.o,{id:"test-address-input",name:"test-address",onChange:ue,label:r({id:(0,s.Z)("Settings.email.plugin.label.testAddress"),defaultMessage:"Recipient email"}),value:y,error:((t=o.email)==null?void 0:t.id)&&r({id:(0,s.Z)(`${(n=o.email)==null?void 0:n.id}`),defaultMessage:"This is an invalid email"}),placeholder:r({id:(0,s.Z)("Settings.email.plugin.placeholder.testAddress"),defaultMessage:"ex: developer@example.com"})})),e.createElement(u.P,{col:7,s:12},e.createElement(V.z,{loading:j,disabled:!re,type:"submit",startIcon:e.createElement(W.Z,null)},r({id:(0,s.Z)("Settings.email.plugin.button.test-email"),defaultMessage:"Send test email"}))))))))))},ie=se},23293:(N,Z,a)=>{a.d(Z,{Z:()=>C});var e=a(67294),S=Object.defineProperty,d=Object.getOwnPropertySymbols,T=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,h=(u,c,m)=>c in u?S(u,c,{enumerable:!0,configurable:!0,writable:!0,value:m}):u[c]=m,P=(u,c)=>{for(var m in c||(c={}))T.call(c,m)&&h(u,m,c[m]);if(d)for(var m of d(c))b.call(c,m)&&h(u,m,c[m]);return u};function C(u){return e.createElement("svg",P({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},u),e.createElement("path",{d:"M0 2.8A.8.8 0 01.8 2h22.4a.8.8 0 01.8.8v2.71a1 1 0 01-1 1H1a1 1 0 01-1-1V2.8z",fill:"#32324D"}),e.createElement("path",{d:"M1.922 7.991C.197 6.675 0 6.252 0 5.289h23.953c.305 1.363-1.594 2.506-2.297 3.125-1.953 1.363-6.253 4.36-7.828 5.45-1.575 1.09-3.031.455-3.562 0-2.063-1.41-6.62-4.557-8.344-5.873zM22.8 18H1.2c-.663 0-1.2.471-1.2 1.053v1.894C0 21.529.537 22 1.2 22h21.6c.663 0 1.2-.471 1.2-1.053v-1.894c0-.582-.537-1.053-1.2-1.053z",fill:"#32324D"}),e.createElement("path",{d:"M0 9.555v10.972h24V9.554c-2.633 1.95-8.367 6.113-9.96 7.166-1.595 1.052-3.352.438-4.032 0L0 9.555z",fill:"#32324D"}))}}}]);
